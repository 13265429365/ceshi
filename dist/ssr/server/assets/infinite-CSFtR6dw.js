import{defineComponent as b,ref as p,onMounted as x,useSSRContext as P,resolveComponent as v,mergeProps as C,withCtx as S,renderSlot as w,openBlock as L,createBlock as R,createVNode as h,createCommentVNode as j}from"vue";import{ssrRenderComponent as y,ssrRenderSlot as k}from"vue/server-renderer";import{_ as B}from"../server-entry.js";const _=b({name:"infiniteIndex",__name:"infinite",props:{request:{required:!0,type:Function,default:()=>()=>{}},params:{required:!0,default:()=>({pagination:{descending:!0,page:1,rowsPerPage:10,sortBy:"createdAt"}})},height:{required:!0,type:Number,default:()=>1e3}},emits:["updatePage"],setup(o,{expose:i,emit:r}){const n=o,a=r,e=p(!0),d=p(!1),l=p([]),c=p(!1);x(()=>{setTimeout(()=>{c.value=!0},100)});const u=()=>{console.log("初始化"),l.value=[],e.value=!1,a("updatePage",1),m()},m=async(f,s)=>{console.log("加载",f);try{d.value=!0,n.request(n.params).then(g=>{g.items.length<n.params.pagination.rowsPerPage?(e.value=!0,l.value.push(...g.items)):(l.value.push(...g.items),a("updatePage",n.params.pagination.page+1)),d.value=!1})}finally{s&&s()}};i({loadMore:m,initData:u});const t={props:n,emit:a,disable:e,loading:d,itemList:l,ready:c,initData:u,loadMore:m};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}});function M(o,i,r,n,a,e,d,l){const c=v("q-infinite-scroll"),u=v("q-spinner-dots");e.ready?i(y(c,C({onLoad:e.loadMore,offset:0,debounce:400,disable:e.disable,style:{minHeight:a.height+"px"},class:"q-pb-md"},n),{default:S((m,t,f,s)=>{if(t)k(o.$slots,"default",{itemList:e.itemList},null,t,f,s),e.loading?(t(`<div class="row justify-center"${s}>`),t(y(u,{color:"primary",size:"40px"},null,f,s)),t("</div>")):t("<!---->");else return[w(o.$slots,"default",{itemList:e.itemList}),e.loading?(L(),R("div",{key:0,class:"row justify-center"},[h(u,{color:"primary",size:"40px"})])):j("",!0)]}),_:3},r)):i("<!---->")}const q=_.setup;_.setup=(o,i)=>{const r=P();return(r.modules||(r.modules=new Set)).add("src/components/mobile/infinite.vue"),q?q(o,i):void 0};const A=B(_,[["ssrRender",M],["__file","infinite.vue"]]);export{A as i};
