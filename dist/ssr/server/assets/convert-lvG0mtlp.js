import{ref as u,reactive as F,toRefs as S}from"vue";import{b as n,i as Y,u as C,N as f}from"../server-entry.js";import{date as I}from"quasar";import{w as M}from"./assets-DxW8phUF.js";import{useI18n as T}from"vue-i18n/dist/vue-i18n.runtime.node.mjs";import{useRouter as b}from"vue-router";import{u as R}from"./info-ChQOlZzO.js";const $=e=>n.post("/auth/wallets/convert/create",e,{showLoading:!0}),k=e=>n.post("/auth/wallets/convert/index",e,{showLoading:!0}),N=e=>n.post("/auth/wallets/convert/info",e,{showLoading:!0}),q=()=>{const e=T(),d=b(),v=Y(),r=C(),a=new Date,A=new Date(a.getTime()-7*24*60*60*1e3),p=I.formatDate(a,"YYYY/MM/DD"),l=I.formatDate(A,"YYYY/MM/DD"),c="from",P="to",i=u(null),w=u(null),s=F({params:{createdAt:{from:l,to:p},pagination:{descending:!0,page:1,rowsPerPage:10,sortBy:"createdAt"}},convertParams:{assetsId:0,toAssetsId:1},assetsList:[],assetsInfo:{id:0,name:"",icon:"",userAssets:{money:0}},toAssetsInfo:{id:0,name:"",icon:"",userAssets:{money:0}},showPreview:!1,showAssetsPopup:!1,AssetsType:"",rate:""}),h=()=>{s.assetsList.push({id:0,name:e.t("balance"),icon:"",userAssets:{money:r.userInfo.money}}),M().then(t=>{s.assetsInfo=s.assetsList[0],s.toAssetsInfo=t[0],s.convertParams.toAssetsId=s.toAssetsInfo.id,t.forEach(o=>{s.assetsList.push(o)})})},y=(t,o)=>{if(s.showAssetsPopup=!1,t==c){s.assetsInfo=o,s.convertParams.assetsId=s.assetsInfo.id;return}s.toAssetsInfo=o,s.convertParams.toAssetsId=s.toAssetsInfo.id},g=()=>{if(!s.convertParams.money){f("negative",e.t("enterMoney"));return}N({assetsId:s.convertParams.assetsId,ToAssetsId:s.convertParams.toAssetsId}).then(t=>{s.showPreview=!0,s.rate=t.rate})},D=()=>{v.setting.wallets.showConvertSecurityKey?i.value?.openFunc():m()},m=()=>{s.convertParams.money=Number(s.convertParams.money),$(s.convertParams).then(()=>{R().then(t=>{r.updateUserInfo(t)}),f("positive",e.t("success")),d.push({name:"WalletsConvertRecord"})})},L=()=>{const t={...s.assetsInfo},o={...s.toAssetsInfo};s.assetsInfo=o,s.toAssetsInfo=t,s.convertParams.assetsId=s.assetsInfo.id,s.convertParams.toAssetsId=s.toAssetsInfo.id,s.convertParams.money=""};return{securityDialogRef:i,pagination:w,ConvertSideFrom:c,ConvertSideTo:P,...S(s),walletsAssetsListFunc:h,switchAssetsFunc:y,convertInfoFunc:g,submitFunc:D,createConvertFunc:m,invertFunc:L}};export{k as a,q as c};
