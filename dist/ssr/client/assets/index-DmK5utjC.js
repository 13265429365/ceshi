import{aF as n,J as h,$ as d,I as p,z as l,aJ as P,k as y,b1 as I,b2 as u,bi as w}from"./index-BkcOOe94.js";const S=()=>n.get("/captcha/create",{showLoading:!0}),K=t=>n.post("/login",t,{showLoading:!0}),C=t=>n.post("/register",t,{showLoading:!0}),A=()=>{const t=h(),c=d(),r=p(),a=l(),i=P(),e=y({baseURL:"http://192.168.5.135:3040",showTextPassword:{password:!1,cmfPassword:!1,securityKey:!1,cmfSecurityKey:!1},onlineInfo:{icon:"",link:""},loginParams:{username:"",password:"",captchaId:"",captchaVal:""},registerParams:{username:"",password:"",cmfPassword:"",captchaId:"",captchaVal:"",email:"",telephone:"",securityKey:"",cmfSecurityKey:"",code:c.query.code?c.query.code:""},currentCountry:{}}),o=()=>{S().then(s=>{e.loginParams.captchaId=s,e.registerParams.captchaId=s})},f=()=>{K(e.loginParams).then(async s=>{r.updateUserInfo(s.userInfo),r.updateToken(s.token),t.push({name:"HomeIndex"})}).catch(()=>{o()})},g=()=>{if(a.setting.register.showCmfPass&&e.registerParams.password!==e.registerParams.cmfPassword)return u("negative",i.t("twoPasswordsAreDifferent")),!1;if(a.setting.register.showCmfSecurityKey&&e.registerParams.securityKey!==e.registerParams.cmfSecurityKey)return u("negative",i.t("twoSecretKeyAreDifferent")),!1;e.registerParams.telephone=e.currentCountry.code+"|"+e.registerParams.telephone,a.setting.register.showTelephone,C(e.registerParams).then(s=>{r.updateUserInfo(s.userInfo),r.updateToken(s.token),t.push({name:"HomeIndex"})}).catch(()=>{o()})},m=()=>{w().then(s=>{e.onlineInfo=s})};return{...I(e),refreshCaptchaFunc:o,userLoginFunc:f,userRegisterFunc:g,onlineInfoFunc:m}};export{A as u};
