import{Q as v}from"./QImg-QNFGeKBr.js";import{n as K,I as M,z as F,r as y,w as O,E as T,A as j,_ as z,s as n,t as l,B as u,D as i,F as E,C as G,y as o,v as r,K as H,Q,N as S,W as R,U as x,O as c,H as _,G as U,X as W,Y as X,V as J}from"./index-BkcOOe94.js";import{u as Z,Q as $}from"./uploader-Dpe-D8u9.js";import{Q as ee}from"./QBadge-qHtEjqMz.js";import{Q as C}from"./QSelect-DmBxFfGu.js";import{Q as ae,a as oe}from"./QPopupProxy-C5pPrXFv.js";import{Q as D}from"./QItemSection-Dqa7iTHf.js";import{Q as te}from"./QItemLabel-DU8CjsTA.js";import{Q as ne}from"./QItem-CH6F1sXM.js";import{u as le,p as re,s as se}from"./info-Dx04KJx9.js";import{u as de}from"./info-BTh3Os19.js";import{d as Y}from"./date-hLWyfEDb.js";import"./format-DyQxkAtJ.js";import"./QChip-BCI60SaI.js";import"./QMenu-DLKEG6T_.js";import"./selection-DMuMQtZs.js";const ie=K({name:"UserSetting",__name:"index",setup(s,{expose:t}){t();const d=M(),e=F(),g=y([]),b=y({oldPwd:!1,newPwd:!1,cmfPwd:!1}),a=y({}),p=y(!1),P=y(""),{currentCountry:h,genderList:B,userInfoParams:m,passwordParams:L,cmfPassword:q,updateUserInfoFunc:I,updatePasswordFunc:V}=le();O(d,()=>{f()}),T(()=>{f()});const f=()=>{if(g.value=[{name:"avatar",params:"Avatar",value:d.userInfo.Avatar},{name:"nickname",params:"NickName",value:d.userInfo.NickName},{name:"email",params:"email",value:d.userInfo.email},{name:"telephone",params:"telephone",value:d.userInfo.telephone!=""&&d.userInfo.telephone.indexOf("|")>-1?d.userInfo.telephone.split("|")[1]:d.userInfo.telephone},{name:"sex",params:"Sex",value:d.userInfo.Sex},{name:"birthday",params:"Birthday",value:d.userInfo.Birthday},{name:"desc",params:"Desc",value:d.userInfo.Desc},{name:"password",params:"password",value:""},{name:"secretKey",params:"SecretKey",value:""}],m.value={...d.userInfo},P.value=Y.formatDate(m.value.Birthday,"YYYY/MM/DD"),d.userInfo.telephone!=""&&d.userInfo.telephone.indexOf("|")>-1){const w=d.userInfo.telephone.split("|")[0],A=e.countryList.findIndex(N=>N.code==w);h.value=e.countryList[A],m.value.telephone=m.value.telephone.split("|")[1]}else h.value=e.countryList[0]},k={$userStore:d,$initStore:e,settingsList:g,showPwd:b,currentSetting:a,dialogShow:p,dates:P,currentCountry:h,genderList:B,userInfoParams:m,passwordParams:L,cmfPassword:q,updateUserInfoFunc:I,updatePasswordFunc:V,initData:f,openUpdateDialog:w=>{p.value=!0,a.value=w},submit:()=>{a.value.params=="password"||a.value.params=="SecretKey"?V(a.value.params=="password"?re:se,()=>{p.value=!1}):(m.value.Birthday=Y.formatDate(P.value,"YYYY/MM/DD"),m.value.telephone!=""&&(m.value.telephone=h.value.code+"|"+m.value.telephone),I(()=>{f(),p.value=!1}))},updateUserInfo:()=>{de().then(w=>{d.updateUserInfo(w),f(),p.value=!1})},uploader:Z,get imageSrc(){return j}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),me={style:{padding:"48px 100px"}},ue={class:"text-weight-bold text-h5"},pe={class:"col-6 text-body1"},ce={class:"col"},fe={key:0},we={key:1},ve={key:2},ye={key:3,class:"text-body2"},Pe={key:0},he={key:0},_e={key:1},ge={key:2},Se={key:1},be={key:0},Ie={key:1},Ve={class:"text-h6"},ke={key:0,class:"relative row justify-center"},Qe={key:1},xe={key:2},Ue={key:3},Ce={class:"row q-col-gutter-sm"},De={class:"row no-wrap items-center"},Ye={class:"col-8"},Be={key:4},Le={key:5},qe={key:6};function Ae(s,t,d,e,g,b){return n(),l("div",me,[u("div",ue,i(s.$t("userSettings")),1),(n(!0),l(E,null,G(e.settingsList,(a,p)=>(n(),l("div",{class:"row justify-between items-center q-my-lg",key:p},[u("div",pe,i(s.$t(a.name)),1),u("div",ce,[a.params=="password"||a.params=="SecretKey"?(n(),l("div",fe,"******")):a.params=="Avatar"?(n(),l("div",we,[o(Q,null,{default:r(()=>[o(v,{"no-spinner":"",src:e.imageSrc(a.value)},null,8,["src"])]),_:2},1024)])):a.params=="Birthday"?(n(),l("div",ve,i(e.dates),1)):(n(),l("div",ye,[a.params=="Sex"?(n(),l("div",Pe,[a.value==1?(n(),l("div",he,i(s.$t("male")),1)):a.value==2?(n(),l("div",_e,i(s.$t("female")),1)):(n(),l("div",ge,i(s.$t("unknown")),1))])):(n(),l("div",Se,[a.value==""?(n(),l("div",be,"- -")):(n(),l("div",Ie,i(a.value),1))]))]))]),u("div",null,[o(S,{flat:"",label:s.$t("edit"),class:"bg-grey-1 text-grey-8",onClick:P=>e.openUpdateDialog(a)},null,8,["label","onClick"])])]))),128)),o(H,{modelValue:e.dialogShow,"onUpdate:modelValue":t[14]||(t[14]=a=>e.dialogShow=a)},{default:r(()=>[o(R,{style:{width:"350px"}},{default:r(()=>[o(x,null,{default:r(()=>[u("div",Ve,i(s.$t("edit"))+i(s.$t(e.currentSetting.name)),1)]),_:1}),o(x,{class:"q-pt-none"},{default:r(()=>[e.currentSetting.params=="Avatar"?(n(),l("div",ke,[o(e.uploader,{onUploaded:t[0]||(t[0]=a=>{e.userInfoParams[e.currentSetting.params]=a,e.currentSetting.value=a}),style:{width:"100px"}},{default:r(()=>[o($),o(Q,{style:{width:"80px",height:"80px"}},{default:r(()=>[o(v,{"no-spinner":"",src:e.imageSrc(e.currentSetting.value)},null,8,["src"]),o(ee,{floating:"",class:"bg-transparent",style:{top:"70%"}},{default:r(()=>[o(v,{"no-spinner":"",src:"/src/assets/default/edit.png",width:"28px",height:"28px"})]),_:1})]),_:1})]),_:1})])):e.currentSetting.params=="Sex"?(n(),l("div",Qe,[o(C,{outlined:"",modelValue:e.userInfoParams[e.currentSetting.params],"onUpdate:modelValue":t[1]||(t[1]=a=>e.userInfoParams[e.currentSetting.params]=a),options:e.genderList,"option-value":"value","option-label":"name","map-options":"","emit-value":"","dropdown-icon":"expand_more"},null,8,["modelValue","options"])])):e.currentSetting.params=="Birthday"?(n(),l("div",xe,[o(c,{outlined:"",modelValue:e.dates,"onUpdate:modelValue":t[3]||(t[3]=a=>e.dates=a),label:s.$t(e.currentSetting.name),mask:"date"},{append:r(()=>[o(_,{name:"event",class:"cursor-pointer"},{default:r(()=>[o(ae,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[o(oe,{modelValue:e.dates,"onUpdate:modelValue":t[2]||(t[2]=a=>e.dates=a),mask:"YYYY/MM/DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"])])):e.currentSetting.params=="telephone"?(n(),l("div",Ue,[u("div",Ce,[o(C,{outlined:"",modelValue:e.currentCountry,"onUpdate:modelValue":t[4]||(t[4]=a=>e.currentCountry=a),options:e.$initStore.countryList,class:"col-4"},{selected:r(()=>[u("div",De,[o(v,{width:"20px",height:"15px",src:e.imageSrc(e.currentCountry.icon),"no-spinner":"",alt:"",class:"q-mr-xs"},null,8,["src"]),U(" +"+i(e.currentCountry.code),1)])]),option:r(a=>[o(ne,W(X(a.itemProps)),{default:r(()=>[o(D,{avatar:""},{default:r(()=>[o(v,{src:e.imageSrc(a.opt.icon),"no-spinner":"",alt:""},null,8,["src"])]),_:2},1024),o(D,null,{default:r(()=>[o(te,null,{default:r(()=>[U(i(a.opt.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),u("div",Ye,[o(c,{class:"q-ml-xs",outlined:"",modelValue:e.userInfoParams[e.currentSetting.params],"onUpdate:modelValue":t[5]||(t[5]=a=>e.userInfoParams[e.currentSetting.params]=a),label:s.$t("telephone")},null,8,["modelValue","label"])])])])):e.currentSetting.params=="Desc"?(n(),l("div",Be,[o(c,{outlined:"",type:"textarea",modelValue:e.userInfoParams[e.currentSetting.params],"onUpdate:modelValue":t[6]||(t[6]=a=>e.userInfoParams[e.currentSetting.params]=a),label:s.$t(e.currentSetting.name)},null,8,["modelValue","label"])])):e.currentSetting.params=="password"||e.currentSetting.params=="SecretKey"?(n(),l("div",Le,[o(c,{modelValue:e.passwordParams.oldPassword,"onUpdate:modelValue":t[8]||(t[8]=a=>e.passwordParams.oldPassword=a),outlined:"",class:"q-mb-md",type:e.showPwd.oldPwd?"text":"password",label:s.$t("oldPassword")},{append:r(()=>[o(_,{onClick:t[7]||(t[7]=a=>e.showPwd.oldPwd=!e.showPwd.oldPwd),name:e.showPwd.oldPwd?"o_visibility":"o_visibility_off"},null,8,["name"])]),_:1},8,["modelValue","type","label"]),o(c,{modelValue:e.passwordParams.newPassword,"onUpdate:modelValue":t[10]||(t[10]=a=>e.passwordParams.newPassword=a),outlined:"",class:"q-mb-md",type:e.showPwd.newPwd?"text":"password",label:s.$t("password")},{append:r(()=>[o(_,{onClick:t[9]||(t[9]=a=>e.showPwd.newPwd=!e.showPwd.newPwd),name:e.showPwd.newPwd?"o_visibility":"o_visibility_off"},null,8,["name"])]),_:1},8,["modelValue","type","label"]),o(c,{modelValue:e.cmfPassword,"onUpdate:modelValue":t[12]||(t[12]=a=>e.cmfPassword=a),outlined:"",class:"q-mb-md",type:e.showPwd.cmfPwd?"text":"password",label:s.$t("cmfPassword")},{append:r(()=>[o(_,{onClick:t[11]||(t[11]=a=>e.showPwd.cmfPwd=!e.showPwd.cmfPwd),name:e.showPwd.cmfPwd?"o_visibility":"o_visibility_off"},null,8,["name"])]),_:1},8,["modelValue","type","label"])])):(n(),l("div",qe,[o(c,{outlined:"",modelValue:e.userInfoParams[e.currentSetting.params],"onUpdate:modelValue":t[13]||(t[13]=a=>e.userInfoParams[e.currentSetting.params]=a),label:s.$t(e.currentSetting.name)},null,8,["modelValue","label"])]))]),_:1}),o(J,{align:"right",class:"q-mt-md"},{default:r(()=>[o(S,{onClick:e.updateUserInfo,flat:"",label:s.$t("cancel"),color:"grey"},null,8,["label"]),o(S,{onClick:e.submit,flat:"",label:s.$t("submit"),color:"primary"},null,8,["label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const oa=z(ie,[["render",Ae],["__file","index.vue"]]);export{oa as default};
