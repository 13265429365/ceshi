import{aF as o,J as h,$ as p,I as d,z as l,aJ as P,k as y,b1 as I,b2 as u,bi as w}from"./index-BAN5Iapo.js";const S=()=>o.get("/captcha/create",{showLoading:!0}),K=t=>o.post("/login",t,{showLoading:!0}),C=t=>o.post("/register",t,{showLoading:!0}),A=()=>{const t=h(),i=p(),r=d(),a=l(),c=P(),e=y({baseURL:"https://api.ainn.us",showTextPassword:{password:!1,cmfPassword:!1,securityKey:!1,cmfSecurityKey:!1},onlineInfo:{icon:"",link:""},loginParams:{username:"",password:"",captchaId:"",captchaVal:""},registerParams:{username:"",password:"",cmfPassword:"",captchaId:"",captchaVal:"",email:"",telephone:"",securityKey:"",cmfSecurityKey:"",code:i.query.code?i.query.code:""},currentCountry:{}}),n=()=>{S().then(s=>{e.loginParams.captchaId=s,e.registerParams.captchaId=s})},f=()=>{K(e.loginParams).then(async s=>{r.updateUserInfo(s.userInfo),r.updateToken(s.token),t.push({name:"HomeIndex"})}).catch(()=>{n()})},g=()=>{if(a.setting.register.showCmfPass&&e.registerParams.password!==e.registerParams.cmfPassword)return u("negative",c.t("twoPasswordsAreDifferent")),!1;if(a.setting.register.showCmfSecurityKey&&e.registerParams.securityKey!==e.registerParams.cmfSecurityKey)return u("negative",c.t("twoSecretKeyAreDifferent")),!1;e.registerParams.telephone=e.currentCountry.code+"|"+e.registerParams.telephone,a.setting.register.showTelephone,C(e.registerParams).then(s=>{r.updateUserInfo(s.userInfo),r.updateToken(s.token),t.push({name:"HomeIndex"})}).catch(()=>{n()})},m=()=>{w().then(s=>{e.onlineInfo=s})};return{...I(e),refreshCaptchaFunc:n,userLoginFunc:f,userRegisterFunc:g,onlineInfoFunc:m}};export{A as u};
